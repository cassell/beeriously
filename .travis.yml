language: php
php:
- 7.2
sudo: false
services:
- postgresql
addons:
  sauce_connect: true
env:
  global:
  - secure: xieOOoTQoFAQtKFzKyx0NH4o/xlvdDrDTpU2Xkcl2ajrskpMAj4gdFWFJLEtBEICRJMuJ3PrD+8FvXVDNRhJ+JaqTzmpg+thkn5kG330bCh1Od4hLeEstW/jL/lJSvnTSXEHIxvy4cr36m+ixRATgUxtq2CrJZW5hfd2qyAOhZHrg0cCYWDGWegfUHwUiJC3JNYV3FfnRHNqZD0Xby1jhYgpRt4gkzNI1EBKWYWF3b4lXey407N31XKab91PuGqRrr/JYiaIht008cRdTUTdknuh8Np3jFzlPEXz4CCRugXfd0a6vWcSCX51r0tzY+SZg9u/lRia4L6/s+ILsQm4bgoNJ5CSeEiGwS1+m12p3/uZObv2CSCiaOXQgeojEmSip3KgO3etzsr49H2OANXI3b4DucU/jfZt0B6Nqx2Q/safe78tTIN91JU39lwpbGXkIXA+BI71B5GdDAN4ofAo1yYzUElnSrGUW1Z0ZtYWzDpbya2bPUEmLB+0jVKUY8pijQxkeVr6Y2A45QY0eLYYd7yiSoqv6RR9gmlTMrh/S9DtWlgJwMb9O0IiZcWD5m1dBH+gOEsn8wgjdbQr8E7/Fd7yVu6tTJVgZRiKyQBzPqRazH/Cy7h/PRSWzQsg8g+QmWUOMSR036JNutxRBGpg0Rp+Wkaek0wh0tXC2/0/Fcw=
  - secure: xGDlmrnp+DzOevjwLBg6Bxd9mVRnNj85edf/lwGnwb+kwgr57g3npRSjIMgk3dtQ7DWEdcoAfAeBsfb7zBheetW+kdW3H2GWY8CkjyqmHXngHSMozRgFZorAyGaVfi/aaCs6rfPyqD5J0ZgOl25JwQadnWiEFnpFnwyt5S/53sXfLOlUjo4Q96oEI8RzX+1E295bGEitwB//FvNO8iGmtwO4aV+cBz0CWnZewQpVdneqaW00GdecbgQMFePo+KkAhL/jRqUGqpoTE6hxIKJSLUJ9eM2KHK8y6V1YRLJ/zZ96YZuEKLu6OmLR1VghZ5vfp5yIWnG01vlP2al4KeB4zPT9ggBhmBbmVGea96v/QfxTE9WPynhOaj5ofJKHVUsIJDmvvU0IC2ZByIJCt0BYP6cVuO1jGUf4oqSQ3ppBrbFIr+z/6Jnf1BVTVTO3U91GKwappfqLLYPE9JAQlDuVnA4iaAtzEf2ULJK9lLaIPAOI66z9C5SeRgdfUyETfVOEP/yhG0J+3vN5EniJ2jKlXKZ3U0YAnbXHAMPwjJUYiMOvx4HzdSTrTJJ6iADV4bhCcP8Fp3v+6sUiI/IpOBtApG1POJhvsPqSe6kuC8Q8vB8HoHvKLsYYwkgsMqWwIIq2zH6vHCr34Kaz9Sibi/XgpiXhBBqWKRxFKbPB7yeB70k=
  - secure: eIZf9K7VQM/g++d7VPb7pIlntiS9okCSwcpxzfekCClhtQkS6kcf6zxy+sgF/FtRhZI9elcKV6ufVAH6wDwbUW0lBmSrhR+BUhRFixZg8L5lkys4d8OGxkq8NuZkJSPU6sEwV0QWlZwl2Nx1M6ntd4v5WktzovC9EWnHnHtCvntGzwjHXJ+UNZCtm1f7xBjvYoUNN4xq+WvfM/IzT7ubtjPBmmA0BuqkUFZYzQajMk40KcOPXqAXh7K/zf6r9HECE7lU3Y/44itVX84hz15tVnOERctv07bBv4RTqaL3Vhp8SCIKxb4xERCDFPTjWlaHw133mwDmIfWNtx6t1P/rnHcQnYpSlEb9YzxrlSE8lvwAUz+5W8HT1h2xUqeSfBlEhEgayY3D1K4EiccQPvUZ4HSJt42nySHAW89B+2Pq9blW8a+6FNbeq0rB2RcBwHks9kVUIFa+WNB/dSWAD2klVhSP5IGrvtHgksg4GbFVWgxHSQpzv2Kgd4Oxd26hX9hRsohYpOF5+8rwv+6on1pVNGFxdRM4RMcpcMGKUxyg2ATyHLq98CmbGoI3L6cLg2zI9WiccnIhhYt6AAyvfOgFcxq/zfQmNiPPCYFzTSPx2OlQcTIfP0aQssXMavYS94fh3qBUmWVeR/iDnr03H+pzeTlwBSQufjeg2GaNyZH/NSg=
  - secure: ZG/ZKr5Ox/Rf0gXS0cwiUIL1JBNnamSPvTFpge/ds0eT7RNBL5f28sD1ye+msF0YfgX91BVRojdz4ocVfcaAGZUXfVaMmpTroZS1aRviCRPT2xg2MSDh6RSR92n/lOJ05fLoxEtKZWBCqC6gR5jRh9dThtxF64wDVsoXo0nZ1yamIqrGItgr8S+xXzytCsopEt0ARysPpzUNsMqQBuCSkqbq4bY56Blx81Kpu4AMLFr6YBEUPUHSrsztcLbOV9VzMkWZ1IwPgefVKVcQidtTUDalx0rf1xLbgtH94S7OgpK7ErIJGuvOcyvR5oAd6tK8RgLIz841iLuIiEg0nN0Gn86SFPtYkQtg4tu7ylROQVbm/YQ9PoSgslQJFunDoIKjvutkx5NqCNxBTLSuG6XKZ1oFxFejwfW94fMtRMeb4Ucl5CGCtfvHuLb77xfOjLk7ZeTUNDnrUgCa+c4sfXMk3ntE6wg3RxoF9Vu+M375sPfE6qbHFvzQ5o2dQCcabVfkKylQkMg7bZIt27RS0j5UujDgWLZA3+EceUBK7RLMHPIaUJyPlqpcK0Bpd/Auorq60vcBK7cyS1f9/NPfcHp8wEA+NWsUzr6mfj9bslKp6938RG34xyW4D6ME2Nd1QAJ0eV09G2X2iJIUok2Mx/9Z8EENV6ORmfgI+R+jzEVOIgQ=
  - secure: oG66H7AVqCZkiyftlme8VkO2+30JRDQPTTRuy1E2XPLVxBNLhFspenz/FvMPwWGdHOo4XADuynIcT14kyU9aBAiG8Bv3nVffXbmQH8r71ZdZpHVfG9uufSl3bwUSYslWBkhdLIozeamo/bXbXTyhN6dG6FVWcA3UTeAUHKb64fmC3mkD4k7xRxzHLmVvRwCutmw6DyFEHOxVscOkCurUz4pNuJvsVMNxZqXa1AwK0RtoGKzz4SgprzlBgEJgwqVGeHFEpBGpDJbJ5NKW5/6CHAWcR3rA2cBlzFRMoicONdftextfEZO6Qk6VrlaaV1fwc6a2nFXmTzMLiRY3uzq34MSyVeg18h+7kLTLYQxVrD4X/9gBTcac+RxkZjzqAPNI5u88/o428d05nCJy+Sa0LGZ+cyTfQxi1T9fGmqOzRE/ZNDoONURhGM0WBHe/Z4G2j0LgzRDa9OAx1+Oh34u3X/RPBTXjM3uDJ43x/56MYk9SjO+A3rN1B/cV274IPKitBzKoBSynRrSsXSxgJqP2nkT3+eRFEd9IMRZfGEgNeMeKVyrxZfmKCFSnX/tafmlNMOwg9AcmK2MW6g5YwQCWQin9HX7WKPoaES/F1i8S1aOklkUEEmUNFVlfRXiAAeV+zqhcIgIdCkWbfg7O5QQV48yj1AgIEgMmsGAmzwokLmI=
  - secure: tP38w7xpsuJuXjUospgKLWH+8emn7A+Z+bHwip6ryuMwji91MmD92u5mzWAWOZZncFpMgc5fL04avIcwdpXBpY7XIrGYFc9s0B8Vn46kuTmbbyD6/IEJQCROvBHWz0uMIwdKdrST4rYmG484DqjkRyYmX2sqlXMNzNppo24iKiGTeYNzq+8oP9+hhIYqabkY6ntJeKiLR+yRby2df+chjcENb8eXTvzIGcJ6jY1q12rTwIGz//wpcLUTXYO/lvsr/MC1tzkz8QodjhZuFXZd9bQfekFiK3yaJ6aVyXkS9PCeC7KCluEqFiDFvvkP/iDjQ+IJ4jti/zqmrEr0wQYyW5Lcl/kFg7cAh1UMp9Ci43nN2BT7fl6xw9t1UN0oSTcih5ZonkIcGUh/0Bp+EeNUW1pHvGlEbvutR8lRiqI5DCpH8luANpAMeJU4cee1dZd+qqzeehcvwiJDUnzszFO699YORuq576f94DwFh+Zp6s+psou5zvVwN72mb5aZaixml8jajPegqlS8t95hE69JUdTyTu0KlEcSvbM3zrvaIeZHRwOMGGVrRxN7kntUqwMxrYfPGmSZVALx5gGk7Nh17jKWf+iAfNAhGYBTa8Ah6Dgw9QAbyyqV0TFNNDBXczcV9Mp2MZABS6AoXAbeRzAEVyVh4YtI2E2MT6dWt0EFQ64=
  - secure: Vc1nK1ZyZSb2VGgDAemoeJxK5i/umYPNaWcVDYljg7CAIQjSabzHtlpsqpyHvsNZZ/co+ywBJMnSNUJyvsz/mDBE7MPxThAYMwUTbaInjmiUBoLVR2YHgtmMpZOyyZlC8JpmxTr0TqwjCNs+ShS03QggsFFSUvDW+CUDfAEYXrV3uP7rR47HZb3K09OPWdgNV692zDc0OtQOF27/lCRC8GTplwUIiWAGK37CtgLj1hXsYOKScY9YA/O1zkctvKeuSxabcr1TKrNOyL5rOpoHqoWVzzP3jiq/iRyG0tJVZPhES3CjHieKcVcOteLtORQv5WNIpYIU4HR3Ke4ujhhH0lAGKgS2hZZwSpltmwOj9UuSujoPsKk/3kvQIlny1MkpMgbne7oCFkoB3CXTT0ak8WPBGa3a5RYbdVYRMsHb6sNFBrX11fCeH5Dozwci1BnGpHWcTdA6sBPUZqHIvF8X2FuI0TeCI40MlnJrGN5/rCSPJ2BQcR+DvEd/U7s50uocTGRi8u406uvN0na9xMKus2AhskqHdfeMyzB7EVbGlhbkkh1Xc92Q6JhaJ/WV3FJG3nW0VwBn3LCd89vEsa6DgTLYxnLjDRBJ9z/k7mTyGdfAw1G092Idh/4T+HluKBLmN7pAPpBJ+3SsSidDtRhOeqqJh63HJz8eR/c8mTMUTFY=
  - secure: w1mVkKv4Z+Br9YxF5sGhdG+Q1zuymvMyuEKFa0o3o2B0LQPj068AUO064Qz7NHTBhG5hNx34A/F9awKiSFXPAduEGroY0hNcvTQ1YR6gRG/j93UKwX3CHe372s8vEXpWN8jEsVrU1zlfGVgs96W/6X9oMvSp9rYxEbbq8vF+mhTcJ02K/giDlof6wXHBQPYvlGBZ+YBSFU691DTwHdXjn8287XUyzH57q/ZIIQLdGI/4NlX7NPCnW3amdVcFwEWvIsQAZ3OP0tP0EosYzAxfLnhEJa3L9K+kiN6hG1/+1ac+uAcPqLqtGisie3kMg91zTcrlo4yKQ6XZyc1qYbkpPwT3NVCu7mhr75e6YXqa05FF36elyI5yZAxuvL8tcO1XzFEg1hc8jGnirpn0/PpmR42YfqGjicxXX8CmmZFs/ngA8qmM95j2ZpNdJtw5Q9ue2ghSf60ImpKyvFx1C7vgmza+2HTGCfqW9hnaf6YsgkCkPstfjcMrQ3RXNb7e+6FfPY8i70LauvYJlLJxrwFjipAtYd/fs98WTympytkPTwjLPvicmxiJeHAgzbGHzqtAogafscM3nJTjTNTTRigzT5Xh2etFawqPo40rFJMfrlbj7PF8Rgwy/W94RdxeE8Tj6UWjorfJE8AB2qoHlhx5Ng7HlBRoiXnoigbbZdh0cp4=
  - secure: ujyUF+8pMLqIYYR13ldgh+YFymbFVnsiYFIDObGFjrc9yJCxXF4+IGP1+L+UHt8Legw6GCZCd609BgqHSKYyY2RUaWA3O+L6KM0zIEno2fi1/ZmNMlOvUW7h0Kv+Hs1vf0GoB1CAO852PrMVXvS1ew94s9brIs1f2FX22PxHI79pVtXOFoZg5IWYooeoqdEy32o6OWrHt8It0JipmZyL3ZBm/ekPK8/8d7glQop0+7JwjeOkT6A030wpaG1bdAWEEo3BTpqjnh/norUsb+qiXMpby24cUnC/oEJ530K27TAKDoArRIZnJCq0JA+fwwFOIeWDl71LW5QIId9mbRZJOYvzHSZJ0YTVEN2yzHkzfkOOy6TskYTiqDPydbBqbAhTnmzNx2JgLb2hJWGCFcooMld3+/kYBRae0vZaECqIVtxYh6uB84phtJbDVlgOh2MWBiNWYxj8BmyBW2uIo+t41rBkaBcLbkwx6a1iiLBsGa9VYKw6wr0N8qPfVnktZesKXp0+D8iYaRQOzQqSon9egQg9bHo31SkM+63aSdCcz7xyi89iMoQA5nAUhEaArhJRWMXeRlFPKk3y5dgbFJCA5/Acj3Z/d/L3L7GGfLTHXNvwkFcUuvIcUXieuTeVIp/anHXxSWP8sDj93BVtJBVGAFQDEOaBsmFNLu1/Js0kSYY=
cache:
  yarn: true
  directories:
  - "$HOME/.composer/cache"
before_install:
- rm .env.dist
- mv .env.travis .env
- travis_retry composer self-update
install:
- travis_retry composer install --no-interaction --prefer-dist
- yarn install
before_script:
- bin/console cache:clear --no-interaction
- bin/console cache:warmup --no-interaction
- yarn run encore dev
- bin/console beeriously:travis:configure-behat > behat.travis-saucelabs.yml
- bin/console doctrine:database:create
- bin/console doctrine:migrations:migrate --no-interaction
script:
- composer validate --strict
- bin/console lint:yaml config
- bin/console lint:twig templates
- vendor/bin/php-cs-fixer fix --diff --dry-run -v
- vendor/bin/phpstan analyse --level=max ./src ./tests
- vendor/bin/phpunit --no-coverage --configuration ./tests/Unit/phpunit.xml.dist
- vendor/bin/phpunit --no-coverage --configuration ./tests/Integration/phpunit.xml.dist
- bin/console server:start
- tests/Travis/run-behat-tests-on-travis.bash
- bin/console server:stop
deploy:
  provider: heroku
  api_key:
    secure: jkRhiewFJQdTasH1l0LabmcbzqAXN61RSlucPRhRnDU4j/CAc6rcMq1obDz3NLmXusJC12/rGUfd88zyH0/kdK3fVcO2wqnQlJCyfby3MlYlNDOP9cCLfStzPdJooxqcazQhTTpqg2DOsmATAibs26zy+B2OIknyUN9IeS8zoRnzfMYL7JVpc8oTjNHgjHw6dWxrFJHP5aj+qP4OKkFxgy2X7xgq0fSDDnFsrDq3tQ7c8iIskrUGmdQm0wZLtFFx/ewKAvuS1HNcy5Qmtg7wKHK3cTh18XhGkS2YHy2xFZphbvxikR05FS6nRcww/N7QtpWUzqEA8VB8yxx3AHQf9rZgSY82WFG5PxXW+T0PDU1awpL4VyRq26qgoGFFPfUrAeYcnd/dL5GTQQZYj6qh5AVeHylngwBmc3sImjPxVmLw0xhevtkcgVWy37gUQZy3f8BDRH+N4lnkZDLRSd3HH45T/Jt5TDhNKltqgSrV5lnEtW7oQulElhYRf6I9KbwdDWE0wtGOjqGUPIj+iPI5sxSU5Bzu7z/zNRSoHdfG79YHVtA9fJotSOizW5FW/Q1DZol+WJ4sqq3Q/lson4Ns2P8oJbZ6wxlWo2vEq0ghu2g9cA8uMsq7NBFzvfpuCE94nWPs6yTNQvSKRIEztXtF8VdzW07V+o1w5StxMdVW/qs=
  app: beeriously